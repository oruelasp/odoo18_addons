<?xml version="1.0" encoding="utf-8"?>
<odoo>
	
	<template id="sale_order_report" name="report_sale_order">
		<t t-name="web.basic_layout">
			<t t-foreach="docs" t-as="doc">
				<t t-call="web.html_container">
                <div class="article" t-att-data-oe-model="o and o._name" t-att-data-oe-id="o and o.id" t-att-data-oe-lang="o and o.env.context.get('lang')">
                    <style>
							body {
							font-family: 'Arial', 'Helvetica Neue', Helvetica, sans-serif; /* Similar a la fuente de las capturas */
							margin: 0;
							padding: 0;
							background-color: #f8f9fa; /* Un gris claro similar al fondo de la web */
							color: #333; /* Color de texto principal */
							font-size: 10px; /* Base, se ajustará por elementos */
							}
							
							.report-container {
							max-width: 800px;
							margin: 30px auto;
							padding: 25px;
							background-color: #fff;
							border: 1px solid #dee2e6;
							box-shadow: 0 0 15px rgba(0, 0, 0, 0.05);
							}
							
							/* ----- Encabezado del Reporte ----- */
							.report-header {
							display: flex;
							justify-content: space-between;
							align-items: flex-start;
							border-bottom: 2px solid #e0e0e0;
							padding-bottom: 15px;
							margin-bottom: 20px;
							}
							
							.company-info .logo {
							max-width: 90px; /* Ajusta según el tamaño real de tu logo */
							margin-bottom: 15px;
							}
							
							.company-info h1 {
							font-size: 16px;
							color: #212529; /* Un negro/gris oscuro para títulos */
							margin: 0 0 5px 0;
							font-weight: 600;
							}
							
							.company-info p, .client-info p {
							margin: 3px 0;
							font-size: 10px;
							line-height: 1.5;
							}
							.client-info strong {
							color: #444;
							}
							
							.order-details {
							text-align: right;
							}
							
							.order-details h2 {
							font-size: 18px;
							color: #CC0000; /* Rojo Cummins */
							margin: 0 0 10px 0;
							font-weight: bold;
							}
							.order-details p {
							font-size: 10px;
							margin: 3px 0;
							}
							.order-details strong {
							color: #333;
							}
							
							
							/* ----- Sección de Introducción ----- */
							.intro-text {
							margin-bottom: 20px;
							font-size: 11px;
							line-height: 1.6;
							}
							
							/* ----- Tabla de Ítems ----- */
							.items-table {
							width: 100%;
							border-collapse: collapse;
							margin-bottom: 20px;
							font-size: 9.5px;
							}
							
							.items-table th, .items-table td {
							border: 1px solid #ddd;
							padding: 8px 6px; /* Más padding para legibilidad */
							text-align: left;
							vertical-align: top;
							}
							
							.items-table th {
							background-color: #f2f2f2; /* Gris claro para encabezados de tabla */
							font-weight: bold;
							color: #333;
							font-size: 10px;
							}
							
							.items-table .text-right { text-align: right; }
							.items-table .text-center { text-align: center; }
							.items-table .col-item { width: 5%; }
							.items-table .col-code { width: 12%; }
							.items-table .col-desc { width: 28%; }
							.items-table .col-brand { width: 10%; }
							.items-table .col-qty { width: 10%; }
							.items-table .col-price { width: 10%; }
							.items-table .col-discount { width: 10%; }
							.items-table .col-sale-price { width: 10%; }
							.items-table .col-total { width: 10%; }
							
							/* ----- Sección de Totales ----- */
							.totals-section {
							display: flex;
							justify-content: flex-end; /* Alinea los totales a la derecha */
							margin-bottom: 20px;
							}
							
							.totals-table {
							width: 45%; /* Ocupa menos espacio, alineado a la derecha */
							font-size: 10px;
							border:0px;
							}
							.totals-table tbody {
							border:0px;
							}
							.totals-table td {
							padding: 5px 8px;
							border:0px;
							}
							
							.totals-table td:first-child {
							font-weight: bold;
							color: #444;
							border:0px;
							}
							.totals-table td:last-child {
							text-align: right;
							}
							.totals-table .grand {
							border:0px;
							}
							.totals-table .grand-total td {
							font-weight: bold;
							border:0px;
							font-size: 11px;
							border-top: 1px solid #aaa;
							border-bottom: 1px solid #aaa;
							padding-top: 8px;
							padding-bottom: 8px;
							color: #CC0000; /* Rojo Cummins para el total final */
							}
							
							/* ----- Monto en Palabras ----- */
							.amount-in-words {
							font-weight: bold;
							margin-bottom: 25px;
							font-size: 11px;
							padding: 10px;
							background-color: #f8f8f8;
							border-left: 3px solid #CC0000;
							}
							
							/* ----- Información de Envío y Pie de Página ----- */
							.shipping-info, .report-footer {
							margin-bottom: 20px;
							font-size: 10px;
							line-height: 1.6;
							}
							.shipping-info h3, .report-footer h3 {
							font-size: 13px;
							color: #CC0000; /* Rojo Cummins para subtítulos */
							margin-bottom: 8px;
							padding-bottom: 5px;
							border-bottom: 1px solid #eee;
							font-weight: 600;
							}
							.shipping-info p, .report-footer p {
							margin-bottom: 8px;
							}
							.report-footer a {
							color: #CC0000; /* Rojo Cummins para enlaces */
							text-decoration: none;
							}
							.report-footer a:hover {
							text-decoration: underline;
							}
							.report-footer .social-icons img {
							width: 20px; /* Tamaño de iconos sociales */
							margin-right: 5px;
							vertical-align: middle;
							}
							
							/* Utilidades */
							.bold { font-weight: bold; }
						</style>
                    <div class="report-container">
                        <!-- INSTRUCCIONES PARA EL DESARROLLADOR (Comentar o eliminar antes de imprimir el PDF real) -->
                        <!-- FIN DE INSTRUCCIONES -->
                        <header class="report-header">
                            <div class="company-info">
                                <img src="https://upload.wikimedia.org/wikipedia/commons/c/c4/Cummins_logo.svg" alt="Cummins Perú Logo" class="logo"/>
                                <!-- Reemplazar con el logo real via t-att-src="image_data_uri(doc.company_id.logo)" -->
                                <h1>
										DISTRIBUIDORA CUMMINS PERU SAC
									</h1>
                                <p>
										RUC:
										
                                    
                                    <t t-esc="doc.company_id.vat"/>
                                </p>
                                <p>
										Razón Social /Persona:
										
                                    
                                    <t t-esc="doc.company_id.name"/>
                                </p>
                                <br/>
                                <p class="bold">
										Nombre completo:
										
                                    
                                    <t t-esc="doc.partner_id.name"/>
                                </p>
                                <p>
										Celular:
										
                                    
                                    <t t-esc="doc.partner_id.mobile or doc.partner_id.phone"/>
                                </p>
                                <p>
										Dirección:
										
                                    
                                    <t t-esc="doc.partner_id.street"/>
                                </p>
                                <p>
										Correo:
										
                                    
                                    <t t-esc="doc.partner_id.email"/>
                                </p>
                                <p>
										N° de
										
                                    
                                    <t t-esc="doc.partner_id.l10n_latam_identification_type_id.name"/>
										:
										
                                    
                                    <t t-esc="doc.partner_id.vat"/>
                                </p>
                            </div>
                            <div class="order-details">
                                <h2>
										Pedido: #
										
                                    
                                    <t t-esc="doc.name"/>
										-
										
                                    
                                    <t t-esc="doc.id_sap if doc.id_sap != 'ERROR' else ''"/>
                                </h2>
                                <p>
                                    <strong>   
											Fecha y hora de emisión:
										</strong>
                                    <br/>
                                   <t t-set="date_adj" t-value="doc.date_order - datetime.timedelta(hours=5)"/>

                                    <t t-out="date_adj.strftime('%d/%m/%Y %I:%M %p')"/>
                                </p> 
                            </div>
                        </header>
                        <section class="intro-text">
                            <p>
									Por medio de la presente y en atención a su solicitud le hacemos llegar la siguiente oferta por:
								</p>
                        </section>
                        <section class="items-section">
                            <table class="items-table">
                                <thead>
                                    <tr>
                                        <th class="col-item text-center">
												Item
											</th>
                                        <th class="col-code text-center">
												Código de material
											</th>
                                        <th class="col-desc text-center">
												Descripción de material
											</th>
                                        <!-- <th class="col-brand">Marca</th> -->
                                        <th class="col-qty text-center">
												Cantidad solicitada
											</th>
                                        <th class="col-price text-center">
												Precio de lista
											</th>
                                        <th class="col-discount text-center">
												% Descuento
											</th>
                                        <th class="col-sale-price text-center">
												Precio de venta
											</th>
                                        <th class="col-total text-center">
												Valor total
											</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <t t-set="item" t-value="0"/>
                                    <t t-set="total_price" t-value="0"/>
                                    <!-- Total de los precios de venta -->
                                    <t t-set="total_discount" t-value="0"/>
                                    <!-- Total del descuento -->
                                    <t t-set="total_shipping_cost" t-value="0"/>
                                    <t t-set="entrega" t-value="''"/>
                                    <!-- Total del costo de envío -->
                                    <t t-foreach="doc.order_line" t-as="line">
                                        <t t-set="line_price" t-value="line.price_unit * line.product_uom_qty"/>
                                        <t t-set="line_discount" t-value="line_price * (line.discount / 100)"/>
                                        <t t-set="line_sale_price" t-value="line_price - line_discount"/>
                                        <t t-set="line_shipping_cost" t-value="0"/>
                                        <!-- Comprobamos si el tipo de producto es 'service' para sumar el costo de envío -->
                                        <t t-if="line.product_id.type == 'service'">
                                            <t t-set="entrega" t-value="env['delivery.carrier'].sudo().search([('product_id','=', line.product_id.id)], limit=1)"/>
                                            <t t-set="line_shipping_cost" t-value="line_sale_price"/>
                                            <t t-set="total_shipping_cost" t-value="total_shipping_cost + line_shipping_cost"/></t>
                                        <t t-set="total_price" t-value="total_price + line_sale_price"/>
                                        <t t-set="total_discount" t-value="total_discount + line_discount"/>
                                        <t t-if="not entrega">
                                            <t t-set="item" t-value="item + 1"/>

                                            <tr>
                                                <td class="text-center">
                                                    <t t-out="item"/>
                                                    <!--<t t-out="entrega"/>-->
                                                </td>
                                                <td class="text-center">
                                                    <t t-esc="line.product_template_id.default_code"/>
                                                </td>
                                                <td class="text-center">
                                                    <t t-esc="line.name"/>
                                                </td>
                                                <!-- <td>Fleetguard</td> -->
                                                <td class="text-center">
                                                    <t t-esc="line.product_uom_qty"/>
                                                </td>
                                                <td class="text-center">
                                                    <t t-esc="line.price_unit"/>
                                                    <t t-esc="doc.currency_id.name"/>
                                                </td>
                                                <td class="text-center">
                                                    <t t-esc="line.discount"/>
                                                </td>
                                                <td class="text-center">
                                                    <t t-esc="line.price_subtotal"/>
                                                    <t t-esc="doc.currency_id.name"/>
                                                </td>
                                                <td class="text-center">
                                                    <t t-esc="line.price_total"/>
                                                    <t t-esc="doc.currency_id.name"/>
                                                </td>
                                            </tr>
                                        </t>

                                    </t>
                                    <!-- Se repetirían más líneas según el pedido -->
                                </tbody>
                            </table>
                        </section>
                        <section class="totals-section">
                            <table style="border:0px !important;" class="table">
                                <tbody style="border:0px !important;">
                                    <tr style="border:0px !important;">
                                        <td class="col-4" style="border:0px !important;"/>
                                        <td class="col-4" style="border:0px !important;"/>
                                        <td class="col-4" style="border:0px !important;">
                                            <table style="border:0px !important; width:100%;" class="totals-table">
                                                <tbody style="border:0px !important;">
                                                    <tr style="border:0px !important;">
                                                        <td>
                											Valor de venta:
                										</td>
                                                        <!-- Total de los precios de venta sin incluir costo de envío -->
                                                        <t t-set="value_without_shipping" t-value="total_price - line_shipping_cost"/>
                                                        <td>
                                                            <t t-esc="'%.2f' % value_without_shipping"/>
                                                            <t t-esc="doc.currency_id.name"/>
                                                        </td>
                                                    </tr>
                                                    <tr style="border:0px !important;">
                                                        <td>
                											Descuento:
                										</td>
                                                        <td>
                                                            <t t-esc="'%.2f' % total_discount"/>
                                                            <t t-esc="doc.currency_id.name"/>
                                                        </td>
                                                    </tr>
                                                    <tr style="border:0px !important;">
                                                        <td>
                											Costo de envío:
                										</td>
                                                        <td>
                                                            <t t-esc="'%.2f' % line_shipping_cost"/>
                                                            <t t-esc="doc.currency_id.name"/>
                                                        </td>
                                                    </tr>
                                                    <tr style="border:0px !important;">
                                                        <td style="border:0px !important;">
                											IGV (18%):
                										</td>
                                                        <!-- Calculamos IGV sobre el valor sin envío -->
                                                        <t t-set="total_without_tax" t-value="value_without_shipping"/>
                                                        <t t-set="igv" t-value="total_without_tax * 0.18"/>
                                                        <td>
                                                            <t t-esc="'%.2f' % doc.tax_totals['tax_amount_currency']"/>
                                                            <t t-esc="doc.currency_id.name"/>
                                                        </td>
                                                    </tr>
                                                    <tr class="grand-total">
                                                        <td>
                											Precio de venta:
                										</td>
                                                        <!-- Precio final considerando todos los cálculos anteriores -->
                                                        <!-- <t t-set="final_price" t-value="value_without_shipping + total_shipping_cost + igv"/> -->
                                                        <td>
                                                            <t t-esc="'%.2f' % doc.tax_totals['total_amount_currency']"/>
                                                            <!--<t t-esc="doc.tax_totals"/>-->
                                                            <!--<t t-esc="final_price"/>-->
                                                            <t t-esc="doc.currency_id.name"/>
                                                        </td>
                                                    </tr>
                                                </tbody>
                                            </table>
                                        </td>
                                    </tr>
                                </tbody>
                            </table>
                        </section>
                        <section class="amount-in-words">
								Son:
								
                            
                            <t t-esc="doc.amount_text(doc.tax_totals['total_amount_currency'], doc.currency_id.symbol)"/>
                        </section>
                        <t t-if="entrega">
                          <section class="shipping-info">
                            <h3>
									Información de envío:
								</h3>
                            <p>
                                <strong>
										Método de envío:
									</strong>
                                <t t-esc="entrega.name"/>
                            </p>
                            <t t-if="entrega.tipo_entrega == 'envio'">
                                <!-- Mostrar si es Envío a Domicilio -->
                                <div class="envio-domicilio" style="/* display:none; si no aplica */">
                                    <p>
                                        <!-- <strong>En caso sea Envío a domicilio:</strong> -->
                                        <!-- <br/> -->
											Tu pedido será enviado a la siguiente dirección:
											
                                        
                                        <t t-esc="doc.partner_id.name"/>
                                        <br/>
                                        <t t-esc="doc.partner_id.street"/>
                                        <t t-esc="doc.partner_id.l10n_pe_district.name"/>
											-
											
                                        
                                        <t t-esc="doc.partner_id.city_id.name"/>
											-
											
                                        
                                        <t t-esc="doc.partner_id.state_id.name"/>
                                    </p>
                                </div>
                            </t>
                            <t t-else="">
                                <!-- Mostrar si es Recojo en Tienda -->
                                <div class="recojo-tienda" style="/* display:none; si no aplica */">
                                    <p>
                                        <!-- <strong>En caso sea Recojo en tienda:</strong> -->
                                        <!-- <br/> -->
											Tu pedido lo podrás recoger en la tienda:
											
                                        
                                        <br/>
                                        <strong>
                                            <t t-esc="entrega.name_ct or entrega.name"/>
												:
											
                                        
                                        </strong>
                                        <t t-esc="entrega.direccion_local"/>
                                        <br/>
                                        <a t-att-href="entrega.url_maps" target="_blank">
												[Enlace de Google Maps de la Tienda]
											</a>
                                    </p>
                                </div>
                            </t>
                        </section>
                        </t>
                        
                        <footer class="report-footer">
                            <h3>
									¿Necesitas ayuda?
								</h3>
                            <p>
									Si tienes alguna pregunta sobre tu pedido, no dudes en contactarnos. Puedes enviarnos un correo a
									
                                
                                <a t-att-href="'mailto:' + doc.company_id.email or ''" target="_blank">
                                    <t t-esc="doc.company_id.email"/>
                                </a>
									o llamarnos al
									
                                
                                <a t-att-href="'tel:' + doc.company_id.mobile">
                                    <t t-esc="doc.company_id.mobile"/>
                                </a>
									.
								
                            
                            </p>
                            <p>
									Gracias nuevamente por confiar en Distribuidora Cummins Perú S.A.C.
								</p>
                            <p>
									Saludos cordiales,
									
                                
                                <br/>
									El equipo de Distribuidora Cummins Perú S.A.C.
									
                                
                                <br/>
                                <a t-att-href="doc.company_id.website" target="_blank">
                                    <t t-esc="doc.company_id.website"/>
                                </a>
                            </p>
                        </footer>
                    </div>
                </div>
				</t>
			</t>
		</t>
	</template>
    <record id="action_reporte_sale_order" model="ir.actions.report">
        <field name="name">Cotización/orden Cummins</field>
        <field name="model">sale.order</field>
        <field name="report_type">qweb-pdf</field>
        <field name="report_name">niubiz_payment.sale_order_report</field>
        <field name="print_report_name">(object.state in ('draft', 'sent') and 'Cotización - %s' % (object.name)) or 'Orden - %s' % (object.name)</field>
    </record>
</odoo>
